services:
  telegram-bot-api:
    image: aiogram/telegram-bot-api:${TELEGRAM_BOT_API_VERSION:-latest}
    environment:
      TELEGRAM_API_ID: ${TELEGRAM_API_ID}
      TELEGRAM_API_HASH: ${TELEGRAM_API_HASH}
      # Required for 2GB file support - files stored locally instead of fetched from Telegram
      TELEGRAM_LOCAL: 1
    volumes:
      - ./data/telegram-bot-api:/var/lib/telegram-bot-api
    restart: always

  bot:
    depends_on:
      - telegram-bot-api
    environment:
      - TELEGRAM_BASE_URL=http://telegram-bot-api:8081/bot
      - TELEGRAM_BASE_FILE_URL=http://telegram-bot-api:8081/file/bot
      - TELEGRAM_LOCAL=1
    volumes:
      # Share telegram-bot-api data for direct file access in local mode
      - ./data/telegram-bot-api:/var/lib/telegram-bot-api:ro
